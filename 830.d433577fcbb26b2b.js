"use strict";(self.webpackChunktrusted_pool_dapp=self.webpackChunktrusted_pool_dapp||[]).push([[830],{7830:(rt,P,s)=>{s.r(P),s.d(P,{PoolsModule:()=>st});var l=s(6895),p=s(4006),u=s(4581),h=s(3646),f=s(5019),x=s(5981),A=s(9527),_=s(9383),r=s(5861),T=s(8029),C=s(8505),b=s(4004),m=s(9300),w=s(1135),k=s(7579),L=s(590),J=s(9841),y=s(1884),I=s(2722),t=s(4650),g=s(4966),U=s(4542);function N(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"button",3),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.onAddParticipants())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&e){const o=t.oxw();t.Q6J("disabled",!o.isCreator),t.xp6(1),t.hij(" ",t.lcZ(2,2,"Add participants"),"\n")}}function M(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.onFinalizePool())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&e){const o=t.oxw();t.Q6J("disabled",!o.isCreator),t.xp6(1),t.hij(" ",t.lcZ(2,2,"Finalize"),"\n")}}let S=(()=>{class e{constructor(){this.finalize=new t.vpe,this.addParticipants=new t.vpe}onFinalizePool(){this.finalize.emit(this.activePool)}onAddParticipants(){this.addParticipants.emit()}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-pool-actions-panel"]],inputs:{activePool:"activePool",isCreator:"isCreator"},outputs:{finalize:"finalize",addParticipants:"addParticipants"},decls:7,vars:12,consts:[["class","me-3 btn btn-warning btn-sm",3,"disabled","click",4,"ngIf"],["class","me-3 btn btn-success btn-sm",3,"disabled","click",4,"ngIf"],[1,""],[1,"me-3","btn","btn-warning","btn-sm",3,"disabled","click"],[1,"me-3","btn","btn-success","btn-sm",3,"disabled","click"]],template:function(o,n){1&o&&(t.YNc(0,N,3,4,"button",0),t.YNc(1,M,3,4,"button",1),t.TgZ(2,"span",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"span",2),t._uU(6),t.qZA()),2&o&&(t.Q6J("ngIf",!n.activePool.finalized),t.xp6(1),t.Q6J("ngIf",!n.activePool.finalized),t.xp6(2),t.hij("",t.lcZ(4,10,"Status"),": "),t.xp6(2),t.ekj("text-warning","Active"===(null==n.activePool?null:n.activePool.status))("text-success","Filled"===(null==n.activePool?null:n.activePool.status))("text-danger","NoFinalized"===(null==n.activePool?null:n.activePool.status)),t.xp6(1),t.Oqu(null==n.activePool?null:n.activePool.status))},dependencies:[l.O5,_.X$],changeDetection:0}),e})();function D(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",19)(1,"div",20),t._uU(2," Be careful! This operation can only be performed once "),t.qZA(),t.TgZ(3,"div",21),t._UZ(4,"input",22),t.TgZ(5,"button",23),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.saveTokenAddress())}),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",24),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.cancelEditTokenAddress())}),t._uU(9),t.ALo(10,"translate"),t.qZA()()()}if(2&e){const o=t.oxw(2);t.xp6(4),t.ekj("is-invalid",o.editTokenAddressControl.invalid),t.Q6J("formControl",o.editTokenAddressControl),t.xp6(1),t.Q6J("disabled",o.editTokenAddressControl.invalid),t.xp6(1),t.hij(" ",t.lcZ(7,6,"Save")," "),t.xp6(3),t.hij(" ",t.lcZ(10,8,"Cancel")," ")}}function F(e,i){1&e&&(t.TgZ(0,"h6",8)(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"app-icon",25),t.ALo(5,"translate"),t.qZA()),2&e&&(t.xp6(2),t.hij("",t.lcZ(3,2,"Private pool")," "),t.xp6(2),t.Q6J("toolTipText",t.lcZ(5,4,"PrivatableTipKey")))}function Q(e,i){1&e&&(t.TgZ(0,"h6",8)(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"app-icon",25),t.ALo(5,"translate"),t.qZA()),2&e&&(t.xp6(2),t.hij("",t.lcZ(3,2,"Approvable pool")," "),t.xp6(2),t.Q6J("toolTipText",t.lcZ(5,4,"ApprovableTipKey")))}function q(e,i){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Q,6,6,"h6",14),t.TgZ(2,"p",9),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&e){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!0),t.xp6(1),t.ekj("text-danger",!(null!=o.activePool&&o.activePool.approved))("text-success",null==o.activePool?null:o.activePool.approved),t.xp6(1),t.hij(" ",t.lcZ(4,6,null!=o.activePool&&o.activePool.approved?"Approved":"Waiting approve")," ")}}function z(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(3);return t.KtG(a.claim())}),t._uU(1," Claim "),t.qZA()}if(2&e){const o=t.oxw().$implicit,n=t.oxw(2);t.Q6J("disabled",!n.canClaim(o))}}function j(e,i){if(1&e&&(t.TgZ(0,"div",26)(1,"h6",27),t._uU(2),t.qZA(),t.TgZ(3,"div",5)(4,"h5",28),t._uU(5," Share/Accrued/Claimed: "),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"number"),t.ALo(9,"number"),t.ALo(10,"number"),t.qZA()(),t.TgZ(11,"div",21),t.YNc(12,z,2,1,"button",29),t.qZA()()()),2&e){const o=i.$implicit,n=t.oxw(2);t.ekj("border-warning",n.isOwner(o)),t.xp6(2),t.hij(" ",o.account," "),t.xp6(5),t.lnq("",t.lcZ(8,7,o.share),"/",t.lcZ(9,9,o.accrued),"/",t.lcZ(10,11,o.claimed),""),t.xp6(5),t.Q6J("ngIf",n.isOwner(o))}}function O(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",26)(1,"div",30)(2,"button",31),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.nextParticipants())}),t._uU(3),t.ALo(4,"translate"),t.qZA()()()}if(2&e){const o=t.oxw(2);t.xp6(2),t.Q6J("disabled",o.loading),t.xp6(1),t.hij(" ",t.lcZ(4,2,"Load more")," ")}}function E(e,i){if(1&e){const o=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"h5",3),t._uU(4),t.qZA(),t.TgZ(5,"app-pool-actions-panel",4),t.NdJ("finalize",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.finalizePool())})("addParticipants",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.onAddParticipants())}),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"h6",8),t._uU(10,"Pool contract address:"),t.qZA(),t.TgZ(11,"p",9),t._uU(12),t.qZA()(),t.TgZ(13,"div",10)(14,"h6",8),t._uU(15,"Token name:"),t.qZA(),t.TgZ(16,"p",9),t._uU(17),t.qZA()(),t.TgZ(18,"div",10)(19,"h6",8),t._uU(20,"Token amount/filled:"),t.qZA(),t.TgZ(21,"p",9),t._uU(22),t.ALo(23,"number"),t.ALo(24,"number"),t.qZA()()(),t.TgZ(25,"div",6)(26,"div",7)(27,"h6",8),t._uU(28,"Token contract address:"),t.qZA(),t.TgZ(29,"p",11),t._uU(30),t.ALo(31,"translate"),t.TgZ(32,"button",12),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.onEditTokenAddress())}),t._uU(33," Edit "),t.qZA()(),t.YNc(34,D,11,10,"div",13),t.qZA(),t.TgZ(35,"div",10),t.YNc(36,F,6,6,"h6",14),t.qZA(),t.TgZ(37,"div",10),t.YNc(38,q,5,8,"div",0),t.qZA()(),t.TgZ(39,"div",15)(40,"h6",8),t._uU(41),t.ALo(42,"translate"),t.TgZ(43,"span"),t._uU(44),t.qZA()()(),t.TgZ(45,"div",16),t.YNc(46,j,13,13,"div",17),t.YNc(47,O,5,4,"div",18),t.qZA()()(),t.BQk()}if(2&e){const o=t.oxw();t.xp6(4),t.AsE("# ",null==o.activePool?null:o.activePool.name," (",null==o.activePool?null:o.activePool.tokenName,")"),t.xp6(1),t.Q6J("isCreator",o.isCreator)("activePool",o.activePool),t.xp6(7),t.Oqu(null==o.activePool?null:o.activePool.contractAddress),t.xp6(5),t.Oqu(null==o.activePool?null:o.activePool.tokenName),t.xp6(5),t.AsE(" ",t.lcZ(23,19,null==o.activePool?null:o.activePool.tokenAmount),"/",t.lcZ(24,21,null==o.activePool?null:o.activePool.filledAmount)," "),t.xp6(7),t.ekj("text-danger",!(null!=o.activePool&&o.activePool.tokenAddress)),t.xp6(1),t.hij(" ",null!=o.activePool&&o.activePool.tokenAddress?null==o.activePool?null:o.activePool.tokenAddress:t.lcZ(31,23,"Token address not set")," "),t.xp6(2),t.Q6J("disabled",o.disabledEditTokenAddress),t.xp6(2),t.Q6J("ngIf",o.isEditTokenAddress),t.xp6(2),t.Q6J("ngIf",null==o.activePool?null:o.activePool.privatable),t.xp6(2),t.Q6J("ngIf",o.activePool.approverAddress),t.xp6(3),t.hij(" ",t.lcZ(42,25,"Participants"),": "),t.xp6(3),t.Oqu(null==o.activePool?null:o.activePool.participantsCount),t.xp6(2),t.Q6J("ngForOf",o.prepParticipants(o.participants)),t.xp6(1),t.Q6J("ngIf",!(null!=o.activePool&&o.activePool.privatable)&&!o.isLastParticipants&&o.participants.length)}}let Y=(()=>{class e{constructor(){this.tokenAddressChange=new t.vpe,this.claimTokens=new t.vpe,this.nextParticipantsLoad=new t.vpe,this.nextPoolsLoad=new t.vpe,this.activePoolChange=new t.vpe,this.finalize=new t.vpe,this.addParticipants=new t.vpe,this.editTokenAddressControl=new p.NI("",[p.kI.required,U.m.isAddress]),this.isEditTokenAddress=!1}get isCreator(){return this.activePool?.adminAddress===this.userAccount}get isLastParticipants(){return this.participants.length>=this.activePool?.participantsCount}get disabledEditTokenAddress(){return!!this.activePool?.tokenAddress||this.isEditTokenAddress||!this.isCreator||!this.activePool.finalized}ngOnChanges(o){o.hasOwnProperty("activePool")&&(this.isEditTokenAddress=!1)}prepParticipants(o){return(o??[]).sort((n,a)=>n.account===this.userAccount?-1:1)}isOwner(o){return o.account===this.userAccount}canClaim(o){return this.isOwner(o)&&!!o.accrued}onEditTokenAddress(){this.isEditTokenAddress=!0}cancelEditTokenAddress(){this.isEditTokenAddress=!1}saveTokenAddress(){this.tokenAddressChange.emit([this.editTokenAddressControl.value,this.activePool]),this.cancelEditTokenAddress()}claim(){this.claimTokens.emit(this.activePool)}nextParticipants(){this.nextParticipantsLoad.emit(this.activePool)}finalizePool(){this.finalize.emit(this.activePool)}onAddParticipants(){this.addParticipants.emit()}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-pool-view"]],inputs:{userAccount:"userAccount",activePool:"activePool",loading:"loading",participants:"participants"},outputs:{tokenAddressChange:"tokenAddressChange",claimTokens:"claimTokens",nextParticipantsLoad:"nextParticipantsLoad",nextPoolsLoad:"nextPoolsLoad",activePoolChange:"activePoolChange",finalize:"finalize",addParticipants:"addParticipants"},features:[t.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[1,"card","text-bg-dark","shadow-lg","bg-opacity-75"],[1,"card-header","d-flex"],[1,"m-0"],[1,"ms-auto",3,"isCreator","activePool","finalize","addParticipants"],[1,"card-body"],[1,"row","mb-3"],[1,"col-6"],[1,"card-title"],[1,"card-text"],[1,"col-3"],[1,"card-text","d-flex"],[1,"ms-auto","btn","btn-success","btn-sm",3,"disabled","click"],["class","",4,"ngIf"],["class","card-title",4,"ngIf"],[1,"mb-3"],[1,"d-flex","overflow-auto"],["class","card text-bg-dark me-2 mb-2 w250",3,"border-warning",4,"ngFor","ngForOf"],["class","card text-bg-dark me-2 mb-2 w250",4,"ngIf"],[1,""],[1,"text-warning","mb-1"],[1,"d-flex"],[1,"form-control","form-control-sm","bg-dark","text-light","me-2",3,"formControl"],[1,"btn","btn-success","btn-sm","me-2",3,"disabled","click"],[1,"btn","btn-danger","btn-sm",3,"click"],["icon","icon-info-circled",1,"text-warning","ms-1",3,"toolTipText"],[1,"card","text-bg-dark","me-2","mb-2","w250"],[1,"card-header"],[1,"card-title","fs-6","m-0"],["class","ms-auto btn btn-success btn-sm",3,"disabled","click",4,"ngIf"],[1,"card-body","d-flex","align-items-center"],[1,"m-auto","btn","btn-warning","btn-sm","fs-3",3,"disabled","click"]],template:function(o,n){1&o&&t.YNc(0,E,48,27,"ng-container",0),2&o&&t.Q6J("ngIf",n.activePool)},dependencies:[l.sg,l.O5,p.Fj,p.JJ,p.oH,f.o,S,l.JJ,_.X$],styles:[".list-group[_ngcontent-%COMP%]{--bs-list-group-bg: none;--bs-list-group-color:var(--app-font-light-color);--bs-list-group-action-hover-bg: var(--app-warn-color);--bs-list-group-border-color: var(--app-font-light-color);--bs-list-group-action-hover-color: var(--app-font-dark-color)}"],changeDetection:0}),e})();function G(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"a",4),t.NdJ("click",function(){const c=t.CHM(o).index,v=t.oxw(2);return t.KtG(v.onActivePool(c))}),t._uU(1),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA()()}if(2&e){const o=i.$implicit,n=t.oxw(2);t.ekj("app-danger",!o.finalized)("app-selected",n.isTabActive(o)),t.xp6(1),t.AsE(" ",o.name,"(",o.tokenName,") "),t.xp6(2),t.hij(" ",o.privatable?t.lcZ(4,7,"Private pool"):""," ")}}function H(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"a",5),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.onNextPools())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Load more"),"... "))}function K(e,i){if(1&e&&(t.TgZ(0,"div",1),t.YNc(1,G,5,9,"a",2),t.YNc(2,H,3,3,"a",3),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngForOf",o.pools),t.xp6(1),t.Q6J("ngIf",!o.isLastPools)}}let $=(()=>{class e{constructor(){this.nextPools=new t.vpe,this.activePoolChange=new t.vpe}isTabActive(o){return this.activePool?.contractAddress===o.contractAddress}onNextPools(){this.nextPools.emit()}onActivePool(o){this.activePoolChange.emit(o)}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-pools-menu"]],inputs:{pools:"pools",activePool:"activePool",isLastPools:"isLastPools"},outputs:{nextPools:"nextPools",activePoolChange:"activePoolChange"},decls:1,vars:1,consts:[["class","list-group",4,"ngIf"],[1,"list-group"],["class","list-group-item list-group-item-action c-pointer app-list-group-item bg-opacity-75",3,"routerLink","app-danger","app-selected","click",4,"ngFor","ngForOf"],["class","list-group-item c-pointer text-center list-group-item-action app-list-group-item bg-opacity-75",3,"routerLink","click",4,"ngIf"],[1,"list-group-item","list-group-item-action","c-pointer","app-list-group-item","bg-opacity-75",3,"routerLink","click"],[1,"list-group-item","c-pointer","text-center","list-group-item-action","app-list-group-item","bg-opacity-75",3,"routerLink","click"]],template:function(o,n){1&o&&t.YNc(0,K,3,2,"div",0),2&o&&t.Q6J("ngIf",null==n.pools?null:n.pools.length)},dependencies:[l.sg,l.O5,u.rH,_.X$],changeDetection:0}),e})();function V(e,i){if(1&e&&(t.TgZ(0,"p",14),t._uU(1),t.qZA()),2&e){const o=t.oxw(2).ngIf;t.xp6(1),t.hij(" You participated in ",null==o.userPools?null:o.userPools.length," pools ")}}function X(e,i){1&e&&(t.TgZ(0,"p",14),t._uU(1," You have not participated in pools, yet "),t.qZA())}function B(e,i){1&e&&(t.TgZ(0,"p",15),t._uU(1,"You can create new pool"),t.qZA())}function W(e,i){1&e&&(t.TgZ(0,"p",15),t._uU(1," You cannot create new pool while there is not finalized pool "),t.qZA())}function R(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",9),t.YNc(1,V,2,1,"p",10),t.YNc(2,X,2,0,"p",10),t.TgZ(3,"div",11),t.YNc(4,B,2,0,"p",12),t.YNc(5,W,2,0,"p",12),t.TgZ(6,"button",13),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.showCreatingForm())}),t._uU(7),t.ALo(8,"translate"),t.qZA()()()}if(2&e){const o=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",null==o.userPools?null:o.userPools.length),t.xp6(1),t.Q6J("ngIf",!(null!=o.userPools&&o.userPools.length)),t.xp6(2),t.Q6J("ngIf",o.state.canCreatePool),t.xp6(1),t.Q6J("ngIf",!o.state.canCreatePool),t.xp6(1),t.Q6J("disabled",!o.state.canCreatePool),t.xp6(1),t.hij(" ",t.lcZ(8,6,"Create pool")," ")}}function tt(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",16)(1,"app-pools-menu",17),t.NdJ("activePoolChange",function(a){t.CHM(o);const c=t.oxw(2);return t.KtG(c.goToPool(a))})("nextPools",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.nextPools())}),t.qZA(),t.TgZ(2,"app-pool-view",18),t.NdJ("claimTokens",function(a){t.CHM(o);const c=t.oxw(2);return t.KtG(c.claimTokens(a))})("tokenAddressChange",function(a){t.CHM(o);const c=t.oxw(2);return t.KtG(c.tokenAddressChange(a))})("nextParticipantsLoad",function(a){t.CHM(o);const c=t.oxw(2);return t.KtG(c.nextParticipants(a))})("activePoolChange",function(a){t.CHM(o);const c=t.oxw(2);return t.KtG(c.goToPool(a))})("finalize",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.finalizePool())})("addParticipants",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.showParticipantsForm())}),t.qZA()()}if(2&e){const o=t.oxw().ngIf;t.xp6(1),t.Q6J("pools",o.userPools)("activePool",o.localState.activePool)("isLastPools",o.state.isLastPools),t.xp6(1),t.Q6J("userAccount",o.state.userAccount)("participants",o.state.participants)("activePool",o.localState.activePool)("loading",o.loading)}}function ot(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",28)(1,"button",29),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(3);return t.KtG(a.closeParticipantsForm())}),t.qZA()()}}function nt(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22)(4,"h5",15),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.YNc(7,ot,2,0,"div",23),t.qZA(),t.TgZ(8,"div",24)(9,"span",8),t._uU(10),t.ALo(11,"translate"),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"div",8)(14,"span"),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"span"),t._uU(18),t.ALo(19,"translate"),t.qZA()()()(),t.TgZ(20,"app-participants",25),t.NdJ("participantsChanges",function(a){t.CHM(o);const c=t.oxw(2);return t.KtG(c.onParticipantsChanges(a))})("validnessChanges",function(a){t.CHM(o);const c=t.oxw(2);return t.KtG(c.onValidnessChanges(a))}),t.qZA(),t.TgZ(21,"div",26)(22,"button",27),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.addToPool())}),t._uU(23),t.ALo(24,"translate"),t.qZA()()()()}if(2&e){const o=t.oxw().ngIf,n=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,14,"Add participant")),t.xp6(2),t.Q6J("ngIf",o.localState.participants.length),t.xp6(3),t.AsE(" ",t.lcZ(11,16,"Token amount"),": ",t.lcZ(12,18,n.tokenAmount(o.localState.participants))," "),t.xp6(4),t.ekj("text-danger",n.isOverParticipants),t.xp6(1),t.AsE(" ",t.lcZ(16,20,"Participant count"),": ",o.localState.participants.length," "),t.xp6(3),t.AsE(" (",t.lcZ(19,22,"Max participants per Ts"),": ",n.MAX_POOL_PARTICIPANTS,") "),t.xp6(2),t.Q6J("readOnly",o.loading)("excludedParticipants",n.mapToAccount(null==o.state?null:o.state.participants)),t.xp6(2),t.Q6J("disabled",!o.localState.participantsValidness||n.isOverParticipants),t.xp6(1),t.hij(" ",t.lcZ(24,24,"Add to pool")," ")}}function et(e,i){if(1&e){const o=t.EpF();t.ynx(0),t.TgZ(1,"app-header",1),t.NdJ("connectWallet",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.connectionService.connect())}),t.qZA(),t.TgZ(2,"main",2),t._UZ(3,"app-notification",3),t.TgZ(4,"div",4),t.YNc(5,R,9,8,"div",5),t.YNc(6,tt,3,7,"div",6),t.YNc(7,nt,25,26,"div",7),t.TgZ(8,"div",8),t._uU(9),t.ALo(10,"translate"),t.qZA()()(),t.BQk()}if(2&e){const o=i.ngIf;t.xp6(1),t.Q6J("state",o.state)("loading",o.loading),t.xp6(4),t.Q6J("ngIf",o.state.userConnected),t.xp6(1),t.Q6J("ngIf",o.state.userConnected),t.xp6(1),t.Q6J("ngIf",o.localState.showParticipantsForm),t.xp6(2),t.Oqu(t.lcZ(10,6,"AppInfoKey"))}}const at=function(e,i,o,n){return{state:e,localState:i,userPools:o,loading:n}};let Z=(()=>{class e{constructor(o,n,a,c,v){this.connectionService=o,this.stateService=n,this.contractService=a,this.router=c,this.route=v,this.classes="main-layout flex-shrink-0 flex-grow-1",this.state$=this.stateService.state$.pipe((0,C.b)(d=>{})),this.userPools$=this.state$.pipe((0,b.U)(d=>d.userPools),(0,m.h)(d=>!!d?.length),(0,C.b)(d=>{if(this.localState$.value.activePool){const ct=d.find(({contractAddress:lt})=>lt===this.localState$.value.activePool.contractAddress);this.patchLocalState({activePool:ct})}})),this.MAX_POOL_PARTICIPANTS=T.Sd,this.localState$=new w.X({activePool:null,showParticipantsForm:!1,participants:[]}),this.defaultPLoadParams={first:0,size:25,mergeMode:!1},this.defaultPDataLoadParams={first:0,size:50,mergeMode:!1},this.pLoadParams={...this.defaultPLoadParams},this.dLoadParams={...this.defaultPDataLoadParams},this.destroyed$=new k.x}get isOverParticipants(){return this.localState$.value.participants.length>T.Sd}ngOnInit(){var o=this;return(0,r.Z)(function*(){o.state$.pipe((0,m.h)(({userConnected:n})=>n),(0,L.P)()).subscribe(()=>{o.loadData()}),(0,J.a)([o.route.params,o.userPools$]).pipe((0,y.x)(([n],[a])=>n.id===a.id),(0,m.h)(([n,a])=>!!a.length),(0,I.R)(o.destroyed$)).subscribe(([n,a])=>{const c=n.id?+n.id:0;a[c]?o.activePoolChange(a[c]):o.goToPool(0)})})()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}showCreatingForm(){var o=this;return(0,r.Z)(function*(){o.router.navigate(["/new-pool"])})()}tokenAddressChange(o){var n=this;return(0,r.Z)(function*(){yield n.contractService.setTokenContract(o[0],o[1]),yield n.loadData()})()}claimTokens(o){var n=this;return(0,r.Z)(function*(){yield n.contractService.claimToken(o),yield n.loadData()})()}activePoolChange(o){this.patchLocalState({activePool:o}),this.pLoadParams={...this.defaultPLoadParams},this.contractService.dispatchParticipants(o,this.pLoadParams)}goToPool(o){this.router.navigate(["/pools",o])}nextParticipants(o){var n=this;return(0,r.Z)(function*(){n.pLoadParams={...n.pLoadParams,first:n.pLoadParams.first+n.pLoadParams.size,mergeMode:!0},yield n.contractService.dispatchParticipants(o,n.pLoadParams)})()}nextPools(){const o={...this.defaultPDataLoadParams,first:this.dLoadParams.first+this.defaultPDataLoadParams.size,mergeMode:!0};this.loadData(o)}finalizePool(){var o=this;return(0,r.Z)(function*(){yield o.contractService.finalize(),yield o.loadData()})()}showParticipantsForm(){var o=this;return(0,r.Z)(function*(){o.patchLocalState({showParticipantsForm:!0})})()}closeParticipantsForm(){var o=this;return(0,r.Z)(function*(){o.patchLocalState({showParticipantsForm:!1})})()}addToPool(){var o=this;return(0,r.Z)(function*(){yield o.contractService.addParticipants(o.localState$.value.participants),o.patchLocalState({participants:[],showParticipantsForm:!1}),yield o.loadData()})()}onParticipantsChanges(o){this.patchLocalState({participants:o})}onValidnessChanges(o){this.patchLocalState({participantsValidness:o})}mapToAccount(o=[]){return o.map(n=>n.account)}tokenAmount(o){return o.reduce((n,a)=>n+(a.share||0),0)}patchLocalState(o){this.localState$.next({...this.localState$.value,...o})}loadData(o=this.defaultPDataLoadParams){var n=this;return(0,r.Z)(function*(){n.dLoadParams={...n.dLoadParams,...o},yield n.contractService.dispatchPoolsData(n.dLoadParams)})()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(g.Mo),t.Y36(g.O0),t.Y36(g.U3),t.Y36(u.F0),t.Y36(u.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dashboard"]],hostVars:2,hostBindings:function(o,n){2&o&&t.Tol(n.classes)},decls:5,vars:14,consts:[[4,"ngIf"],[1,"mb-auto",3,"state","loading","connectWallet"],[1,"pt-3","pb-3"],["id","main"],[1,"container"],["class","row fs-5 mb-3",4,"ngIf"],["class","row mb-3",4,"ngIf"],["class","row justify-content-end",4,"ngIf"],[1,""],[1,"row","fs-5","mb-3"],["class","col m-0 d-flex align-items-center",4,"ngIf"],[1,"d-flex","align-items-center","col","justify-content-end"],["class","m-0",4,"ngIf"],[1,"btn","btn-warning","ms-3","fs-5",3,"disabled","click"],[1,"col","m-0","d-flex","align-items-center"],[1,"m-0"],[1,"row","mb-3"],[1,"col-2",3,"pools","activePool","isLastPools","activePoolChange","nextPools"],[1,"col-10",3,"userAccount","participants","activePool","loading","claimTokens","tokenAddressChange","nextParticipantsLoad","activePoolChange","finalize","addParticipants"],[1,"row","justify-content-end"],[1,"col-10","card","text-bg-dark","shadow-lg","bg-opacity-75"],[1,"card-header"],[1,"d-flex","justify-content-between","align-items-center"],["class","d-flex align-items-center",4,"ngIf"],[1,"d-flex","justify-content-between"],[1,"card-body",3,"readOnly","excludedParticipants","participantsChanges","validnessChanges"],[1,"card-footer","d-flex","justify-content-end"],[1,"btn","btn-success","fs-5",3,"disabled","click"],[1,"d-flex","align-items-center"],[1,"btn-close","btn-close-white","fs-5",3,"click"]],template:function(o,n){1&o&&(t.YNc(0,et,11,8,"ng-container",0),t.ALo(1,"async"),t.ALo(2,"async"),t.ALo(3,"async"),t.ALo(4,"async")),2&o&&t.Q6J("ngIf",t.l5B(9,at,t.lcZ(1,1,n.state$),t.lcZ(2,3,n.localState$),t.lcZ(3,5,n.userPools$),t.lcZ(4,7,n.connectionService.loading$)))},dependencies:[l.O5,h.G,x.c,A.g,Y,$,l.Ov,l.JJ,_.X$],changeDetection:0}),e})();const it=[{path:"",component:Z},{path:":id",component:Z}];let st=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,h.G,u.Bz.forChild(it),_.aw,p.UX,f.o,x.c,A.g]}),e})()}}]);